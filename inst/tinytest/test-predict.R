source("utils.R")

x <- c(seq.int(0, 10, 0.5), NA)
bsMat <- bSpline(x)
ibsMat <- ibs(x)
dbsMat <- dbs(x)
msMat <- mSpline(x)
isMat <- iSpline(x)
csMat1 <- cSpline(x)
csMat2 <- cSpline(x, scale = FALSE)
bpMat <- bernsteinPoly(x)
nsMat <- naturalSpline(x, df = 3)

## with newx
expect_eqt(predict(bsMat, 1), bsMat[3L, , drop = FALSE])
expect_eqt(predict(ibsMat, 1), ibsMat[3L, , drop = FALSE])
expect_eqt(predict(dbsMat, 1), dbsMat[3L, , drop = FALSE])
expect_eqt(predict(msMat, 1), msMat[3L, , drop = FALSE])
expect_eqt(predict(isMat, 1), isMat[3L, , drop = FALSE])
expect_eqt(predict(csMat1, 1), csMat1[3L, , drop = FALSE])
expect_eqt(predict(csMat2, 1), csMat2[3L, , drop = FALSE])
expect_eqt(predict(bpMat, 1), bpMat[3L, , drop = FALSE])
expect_eqt(predict(nsMat, 1), nsMat[3L, , drop = FALSE])

## without newx
expect_eqt(predict(bsMat), bsMat)
expect_eqt(predict(ibsMat), ibsMat)
expect_eqt(predict(dbsMat), dbsMat)
expect_eqt(predict(msMat), msMat)
expect_eqt(predict(isMat), isMat)
expect_eqt(predict(csMat1), csMat1)
expect_eqt(predict(csMat2), csMat2)
expect_eqt(predict(bpMat), bpMat)
expect_eqt(predict(nsMat), nsMat)
